<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Oldneto</title>

  <style>
  :root{
    --bg0:#0b0f14;
    --bg1:#0d131c;
    --card0:rgba(255,255,255,.055);
    --card1:rgba(255,255,255,.035);
    --border:rgba(255,255,255,.12);
    --text:rgba(255,255,255,.92);
    --muted:rgba(255,255,255,.62);
    --muted2:rgba(255,255,255,.46);
    --accent:#7aa7ff;
    --accent2:#37d2a6;
    --danger:#ff6b7a;
    --shadow: 0 18px 70px rgba(0,0,0,.58);
    --radius:18px;
  }

  *{ box-sizing:border-box; }
  html,body{ height:100%; }

  body{
    margin:0;
    color:var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
    line-height:1.45;
    background:
      radial-gradient(900px 700px at 10% 0%, rgba(122,167,255,.16), transparent 62%),
      radial-gradient(800px 650px at 90% 8%, rgba(55,210,166,.10), transparent 60%),
      radial-gradient(900px 700px at 50% 95%, rgba(255,107,122,.08), transparent 60%),
      linear-gradient(180deg, var(--bg0), var(--bg1));
  }

  a{ color: var(--accent); text-decoration:none; }
  a:hover{ text-decoration:underline; }

  #app{
    min-height: 100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding: 20px 14px 26px;
  }

  .shell{
    width: min(980px, 92vw);
    display:flex;
    flex-direction:column;
    gap: 12px;
  }

  .topbar{
    display:flex;
    align-items:flex-end;
    justify-content:space-between;
    gap:12px;
    user-select:none;
    padding: 12px 14px;
    border-bottom: 1px solid rgba(255,255,255,.08);
    background: rgba(255,255,255,.045);
    border-radius: var(--radius);
  }

  .brand{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .brand .dot{
    width:10px;height:10px;border-radius:50%;
    background: var(--accent);
    box-shadow: 0 0 18px rgba(122,167,255,.55);
  }
  .brand h1{
    margin:0;
    font-size:16px;
    font-weight:850;
    letter-spacing:.3px;
  }
  .brand small{
    display:block;
    margin-top:2px;
    color:var(--muted2);
    font-size:12px;
    font-weight:650;
  }

  .status{
    color:var(--muted2);
    font-size:12px;
    font-weight:650;
    white-space:nowrap;
  }

  .card{
    border-radius: var(--radius);
    border: 1px solid var(--border);
    background: linear-gradient(180deg, var(--card0), var(--card1));
    box-shadow: var(--shadow);
    backdrop-filter: blur(10px);
    overflow:hidden;
  }

  .chatwrap{
    padding: 14px;
  }

  #chat{
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.16);
    padding: 14px;
    height: 56vh;
    min-height: 360px;
    max-height: 680px;
    overflow:auto;
  }

  #chat::-webkit-scrollbar{ width: 10px; }
  #chat::-webkit-scrollbar-thumb{
    background: rgba(255,255,255,.14);
    border-radius: 999px;
  }
  #chat::-webkit-scrollbar-track{ background: transparent; }

  .system{
    text-align:center;
    color:var(--muted);
    font-size:12px;
    margin: 10px 0;
  }

  .msg{ display:flex; margin: 10px 0; }
  .msg.me{ justify-content:flex-end; }
  .bubble{
    max-width: 78%;
    padding: 10px 12px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.05);
    color: var(--text);
    white-space: pre-wrap;
    word-break: break-word;
  }
  .msg.me .bubble{
    background: rgba(122,167,255,.16);
    border-color: rgba(122,167,255,.26);
  }

  .composer{
    display:flex;
    align-items:center;
    justify-content:center;
    gap: 10px;
    padding: 12px 14px 14px;
    border-top: 1px solid rgba(255,255,255,.08);
    background: rgba(255,255,255,.02);
    flex-wrap: wrap;
  }

  #msg{
    flex: 1;
    min-width: 260px;
    padding: 13px 14px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.22);
    color: var(--text);
    outline:none;
  }
  #msg::placeholder{ color: var(--muted2); }
  #msg:focus{
    border-color: rgba(122,167,255,.55);
    box-shadow: 0 0 0 3px rgba(122,167,255,.18);
  }

  button{
    appearance:none;
    border: 1px solid rgba(255,255,255,.14);
    background: rgba(255,255,255,.07);
    color: var(--text);
    padding: 12px 18px;
    border-radius: 18px;
    cursor:pointer;
    font-weight: 800;
    font-size: 14px;
    letter-spacing:.2px;
    transition: transform .08s ease, background .18s ease, border-color .18s ease, box-shadow .18s ease;
    user-select:none;
    white-space:nowrap;
  }
  button:hover{
    background: rgba(255,255,255,.10);
    border-color: rgba(255,255,255,.20);
  }
  button:active{ transform: translateY(1px); }
      
  #btnFind{
    background: rgba(122,167,255,.20);
    border-color: rgba(122,167,255,.35);
    box-shadow: 0 10px 30px rgba(122,167,255,.10);
  }

  #btnStop{
    background: rgba(255,255,255,.06);
    border-color: rgba(255,255,255,.16);
  }

  #btnReport{
    background: rgba(255,107,122,.14);
    border-color: rgba(255,107,122,.26);
    box-shadow: 0 10px 30px rgba(255,107,122,.08);
  }

  #btnVideo{
    background: rgba(255,255,255,.0.12);
    border-color: rgba(255,255,255,.0.25);
    box-shadow: 0 10px 30px rgba(255,255,255,.0.95);
  }
  
  #btnPhoto{
    background: rgba(255,255,255,.0.12);
    border-color: rgba(255,255,255,.0.25);
    box-shadow: 0 10px 30px rgba(255,255,255,.0.95);
  }
  
  .footer{
    text-align:center;
    color: var(--muted2);
    font-size: 12px;
    padding: 8px 8px 0;
  }

  #gate{
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.66);
    backdrop-filter: blur(12px);
    z-index: 9999;
    display:flex;
    align-items:center;
    justify-content:center;
    padding: 18px 14px;
  }

  .gateCard{
    width: min(720px, 94vw);
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,.14);
    background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
    box-shadow: var(--shadow);
    padding: 16px 16px 14px;
  }

  .gateCard h2{
    margin: 0 0 8px;
    font-size: 16px;
    letter-spacing:.2px;
    font-weight: 900;
  }

  .gateCard p{
    margin: 0 0 10px;
    color: var(--muted);
    font-size: 13px;
  }

  .gateCard ul{
    margin: 0;
    padding-left: 18px;
    color: var(--muted);
    font-size: 13px;
  }
  .gateCard li{ margin: 6px 0; }

  .gateNote{
    margin-top: 10px;
    color: var(--muted2);
    font-size: 12px;
  }

  .gateActions{
    display:flex;
    gap: 10px;
    justify-content:center;
    flex-wrap: wrap;
    margin-top: 12px;
  }

  #btnAgree{
    background: rgba(122,167,255,.20);
    border-color: rgba(122,167,255,.35);
    box-shadow: 0 10px 30px rgba(122,167,255,.10);
    min-width: 160px;
  }

  #btnDecline{
    background: rgba(255,255,255,.06);
    border-color: rgba(255,255,255,.16);
    min-width: 160px;
  }

  @media (max-width: 720px){
    #chat{ height: 60vh; }
    #msg{ width: 100%; min-width: 0; }
    button{ width: 100%; }
  }

#btnStart, #btnPhoto, #btnVideo,
button#start, button#photo, button#video,
button[id*="Start"], button[id*="Photo"], button[id*="Video"],
a#btnStart, a#btnPhoto, a#btnVideo,
a[id*="Start"], a[id*="Photo"], a[id*="Video"],
label#btnStart, label#btnPhoto, label#btnVideo,
label[for*="photo"], label[for*="video"], label[for*="Photo"], label[for*="Video"]{
  display: inline-flex !important;
  align-items: center;
  justify-content: center;
  gap: 8px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.07);
  color: rgba(255,255,255,.92);
  padding: 12px 18px;
  border-radius: 18px;
  cursor: pointer;
  font-weight: 800;
  font-size: 14px;
  letter-spacing: .2px;
  text-decoration: none;
}

/* Accent for Start/Find-like main action */
#btnStart, button#start, button[id*="Start"],
a#btnStart, a[id*="Start"]{
  background: rgba(122,167,255,.20);
  border-color: rgba(122,167,255,.35);
  box-shadow: 0 10px 30px rgba(122,167,255,.10);
}


#btnPhoto, #btnVideo,
button[id*="Photo"], button[id*="Video"],
a[id*="Photo"], a[id*="Video"],
label[for*="photo"], label[for*="video"], label[for*="Photo"], label[for*="Video"]{
  background: rgba(255,255,255,.06);
  border-color: rgba(255,255,255,.16);
}

input[type="file"]{
  position: absolute !important;
  left: -9999px !important;
  width: 1px !important;
  height: 1px !important;
  opacity: 0 !important;
}
</style>

</head>

<body>
  <div id="gate">
    <div class="gateCard">
      <h2>18+ • Friendly chat only</h2>
      <p>By clicking <b>I Agree</b>, you confirm you are 18+ and accept the <a href="/terms.html" target="_blank" rel="noopener">Terms</a> and <a href="/privacy.html" target="_blank" rel="noopener">Privacy Policy</a>.</p>
      <ul>
        <li><b>Strictly prohibited:</b> illegal content, harm or threats, harassment, hate, extremist/terrorist content, violence, self-harm content, doxxing, scams, spam, malware links.</li>
        <li><b>No minors:</b> any content involving minors is forbidden, including any sexual content, exploitation, or grooming.</li>
        <li><b>No sexual exploitation:</b> non-consensual sexual content, coercion, or any form of exploitation is forbidden.</li>
        <li><b>Report & block:</b> use <b>Report</b> for violations and <b>Stop</b> to leave at any time.</li>
      </ul>
      <div class="gateNote">You are responsible for what you share. We may restrict access for abuse. If you do not agree, you cannot use the chat.</div>
      <div class="gateActions">
        <button id="btnAgree" type="button">I Agree</button>
        <button id="btnDecline" type="button">Decline</button>
      </div>
    </div>
  </div>

  <div id="app">
    <div class="shell">
      <div class="topbar">
        <div class="brand">
          <span class="dot"></span>
          <div>
            <h1>Oldneto</h1>
            <small>simple anonymous chat</small>
          </div>
        </div>
        <div class="status">online</div>
      </div>

      <div class="card">
        <div class="chatwrap">
          <div id="chat"></div>
        </div>

        <div class="composer">
          <input id="msg" type="text" placeholder="Type a message…" autocomplete="off" />
          <button id="btnFind" type="button">Find</button>
          <button id="btnStop" type="button">Stop</button>
          <button id="btnReport" type="button">Report</button>
        </div>
      </div>

      <div class="footer">Media limits: photos accepted with confirmation; videos up to 10 seconds, max 40 MB.</div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    const gate = document.getElementById("gate");
    const btnAgree = document.getElementById("btnAgree");
    const btnDecline = document.getElementById("btnDecline");

    const chat = document.getElementById("chat");
    const msg = document.getElementById("msg");

    const btnFind = document.getElementById("btnFind");
    const btnStop = document.getElementById("btnStop");
    const btnReport = document.getElementById("btnReport");

    function addSystem(text){
      const div = document.createElement("div");
      div.className = "system";
      div.textContent = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    function addMsg(text, who){
      const wrap = document.createElement("div");
      wrap.className = "msg " + (who === "me" ? "me" : "other");

      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.textContent = text;

      wrap.appendChild(bubble);
      chat.appendChild(wrap);
      chat.scrollTop = chat.scrollHeight;
    }

    let agreed = false;

    btnAgree.addEventListener("click", () => {
      agreed = true;
      gate.style.display = "none";
      socket.emit("agree");
      addSystem("Ready. Tap Find to start.");
      msg.focus();
    });

    btnDecline.addEventListener("click", () => {
      agreed = false;
      addSystem("You must agree to continue.");
    });

    function requireAgree(){
      if (!agreed){
        addSystem("Please agree to continue.");
        return false;
      }
      return true;
    }

    btnFind.addEventListener("click", () => {
      if (!requireAgree()) return;
      chat.innerHTML = "";
      addSystem("Searching…");
      socket.emit("find");
    });

    btnStop.addEventListener("click", () => {
      if (!requireAgree()) return;
      socket.emit("stop");
      addSystem("Stopped.");
    });

    btnReport.addEventListener("click", () => {
      if (!requireAgree()) return;
      socket.emit("report");
      addSystem("Report sent.");
    });

    msg.addEventListener("keydown", (e) => {
      if (e.key !== "Enter") return;
      const text = msg.value.trim();
      if (!text) return;
      if (!requireAgree()) return;
      socket.emit("msg", text);
      addMsg(text, "me");
      msg.value = "";
    });

    socket.on("system", (t) => addSystem(String(t || "")));
    socket.on("msg", (t) => addMsg(String(t || ""), "other"));

    socket.on("paired", () => {
      chat.innerHTML = "";
      addSystem("Connected.");
    });

    socket.on("stopped", () => addSystem("Chat ended."));
    socket.on("banned", () => {
      gate.style.display = "flex";
      addSystem("Access blocked.");
    });
  </script>
</body>
</html>
